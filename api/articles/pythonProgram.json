{"title":"ä¸èŠ­å•†åŸç«ä»·æ•°æ®ç»Ÿè®¡","uid":"f3519b3c4b337b4d2b1c684904d9f509","slug":"pythonProgram","date":"2025-03-10T14:31:23.000Z","updated":"2025-07-28T02:27:19.087Z","comments":true,"path":"api/articles/pythonProgram.json","keywords":null,"cover":"./images/resume_icon.jpg","content":"<div class=\"custom-quote warning\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 8V13\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 15.99V16.01\"></path>\n</svg>\n</span>\n<p class=\"custom-quote-title\">WARNING</p>\n<p>æœ¬ç³»ç»Ÿä»…é€‚ç”¨äºä¸èŠ­å•†åŸï¼Œå…¶ä»–å•†åŸè¯·è‡ªè¡Œä¿®æ”¹ä»£ç ã€‚<br>æœ¬ç³»ç»Ÿçˆ¬è™«ä»…ç”¨äºå­¦ä¹ äº¤æµï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚</p>\n</div>\n<h1 id=\"ä¸èŠ­å•†åŸæ•°æ®å¯¼å‡ºå·¥å…·\"><a href=\"#ä¸èŠ­å•†åŸæ•°æ®å¯¼å‡ºå·¥å…·\" class=\"headerlink\" title=\"ä¸èŠ­å•†åŸæ•°æ®å¯¼å‡ºå·¥å…·\"></a>ä¸èŠ­å•†åŸæ•°æ®å¯¼å‡ºå·¥å…·</h1><h2 id=\"é¡¹ç›®ç®€ä»‹\"><a href=\"#é¡¹ç›®ç®€ä»‹\" class=\"headerlink\" title=\"é¡¹ç›®ç®€ä»‹\"></a>é¡¹ç›®ç®€ä»‹</h2><p>æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªç”¨äº <strong>è‡ªåŠ¨åŒ–æŠ“å–å’Œå¯¼å‡ºä¸èŠ­å•†åŸï¼ˆ<a href=\"https://shop.48.cn)æ‹å–æ•°æ®/\">https://shop.48.cnï¼‰æ‹å–æ•°æ®</a></strong> çš„ Python å·¥å…·ã€‚<br>ç”¨æˆ·å¯ä»¥è·å– <strong>æŒ‡å®šæ‹å–é¡µé¢</strong> çš„ä¿¡æ¯ï¼Œå¹¶å°†å…¶æ•´ç†åå¯¼å‡ºä¸º <strong>Excel æ–‡ä»¶</strong>ã€‚  </p>\n<h2 id=\"åŠŸèƒ½ä»‹ç»\"><a href=\"#åŠŸèƒ½ä»‹ç»\" class=\"headerlink\" title=\"åŠŸèƒ½ä»‹ç»\"></a>åŠŸèƒ½ä»‹ç»</h2><ul>\n<li><strong>è‡ªåŠ¨è·å–æ‹å–æ•°æ®</strong>ï¼šè§£æå•†å“è¯¦æƒ…é¡µï¼Œæå–å…³é”®ä¿¡æ¯ï¼Œå¦‚ç«æ‹ä»·æ ¼ã€å‡ºä»·è®°å½•ç­‰ã€‚  </li>\n<li><strong>æ•°æ®å­˜å‚¨</strong>ï¼šå°†æŠ“å–çš„æ•°æ®å­˜å…¥ Excelï¼Œæ–¹ä¾¿åç»­åˆ†æã€‚  </li>\n<li><strong>Tampermonkey è„šæœ¬æ”¯æŒ</strong>ï¼šæ”¯æŒåœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ Tampermonkey ç›´æ¥è·å–æ•°æ®ã€‚  </li>\n<li><strong>å¤šçº¿ç¨‹ä¼˜åŒ–</strong>ï¼šæå‡è¯·æ±‚æ•ˆç‡ï¼Œå‡å°‘ç­‰å¾…æ—¶é—´ã€‚  </li>\n<li><strong>é˜²åçˆ¬ç­–ç•¥</strong>ï¼šåŠ å…¥è¯·æ±‚é—´éš”æ§åˆ¶ï¼Œé™ä½è¢«å°é£é™©ã€‚</li>\n</ul>\n<h2 id=\"ä»£ç ä¸»è¦å®ç°éƒ¨åˆ†\"><a href=\"#ä»£ç ä¸»è¦å®ç°éƒ¨åˆ†\" class=\"headerlink\" title=\"ä»£ç ä¸»è¦å®ç°éƒ¨åˆ†\"></a>ä»£ç ä¸»è¦å®ç°éƒ¨åˆ†</h2><h3 id=\"ğŸ¯-1-è·å–ç«ä»·æˆåŠŸä¸å¤±è´¥æ•°æ®\"><a href=\"#ğŸ¯-1-è·å–ç«ä»·æˆåŠŸä¸å¤±è´¥æ•°æ®\" class=\"headerlink\" title=\"ğŸ¯ 1.è·å–ç«ä»·æˆåŠŸä¸å¤±è´¥æ•°æ®\"></a>ğŸ¯ <strong>1.è·å–ç«ä»·æˆåŠŸä¸å¤±è´¥æ•°æ®</strong></h3><h4 id=\"ğŸ“Œ-å‡½æ•°ï¼šauto-bid-until-end\"><a href=\"#ğŸ“Œ-å‡½æ•°ï¼šauto-bid-until-end\" class=\"headerlink\" title=\"ğŸ“Œ å‡½æ•°ï¼šauto_bid_until_end\"></a>ğŸ“Œ <strong>å‡½æ•°ï¼š<code>auto_bid_until_end</code></strong></h4><p>æ­¤å‡½æ•°ç”¨äºè‡ªåŠ¨æ‰§è¡Œç«ä»·è¿‡ç¨‹ï¼Œç›´åˆ°è¾¾åˆ°æŒ‡å®šçš„æˆåŠŸç«ä»·æ•°é‡ï¼Œå¹¶æ”¶é›†æ‰€æœ‰ç«ä»·æ•°æ®ï¼ŒåŒ…æ‹¬æˆåŠŸå’Œå¤±è´¥çš„ç«ä»·ä¿¡æ¯ã€‚  </p>\n<h5 id=\"ğŸ“Œ-å‡½æ•°å‚æ•°\"><a href=\"#ğŸ“Œ-å‡½æ•°å‚æ•°\" class=\"headerlink\" title=\"ğŸ“Œ å‡½æ•°å‚æ•°\"></a>ğŸ“Œ <strong>å‡½æ•°å‚æ•°</strong></h5><ul>\n<li><code>driver</code>ï¼šWebDriver å®ä¾‹ï¼Œç”¨äºä¸ç½‘é¡µäº¤äº’ã€‚  </li>\n<li><code>target_successful_count</code>ï¼šç›®æ ‡æˆåŠŸç«ä»·çš„æ•°é‡ã€‚  </li>\n<li><code>bid_type</code>ï¼šç«ä»·ç±»å‹ï¼ˆåº§ä½ç±»åˆ«ï¼‰ã€‚  </li>\n<li><code>theater_name</code>ï¼šå‰§é™¢åç§°ã€‚</li>\n</ul>\n<h5 id=\"ğŸ“œ-ä»£ç å®ç°\"><a href=\"#ğŸ“œ-ä»£ç å®ç°\" class=\"headerlink\" title=\"ğŸ“œ ä»£ç å®ç°\"></a>ğŸ“œ <strong>ä»£ç å®ç°</strong></h5><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">auto_bid_until_end</span>(<span class=\"params\">driver, target_successful_count, bid_type, theater_name</span>):</span><br><span class=\"line\">    successful_bids_data = []  <span class=\"comment\"># å­˜å‚¨æ‰€æœ‰æˆåŠŸç«ä»·ä¿¡æ¯</span></span><br><span class=\"line\">    unsuccessful_bids_data = []  <span class=\"comment\"># å­˜å‚¨æ‰€æœ‰æœªæˆåŠŸç«ä»·ä¿¡æ¯</span></span><br><span class=\"line\">    total_bids_data = []</span><br><span class=\"line\">    wait = WebDriverWait(driver, <span class=\"number\">10</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># è·å–æœ€å¤§é¡µæ•°</span></span><br><span class=\"line\">    max_page_element = driver.find_element(By.XPATH, <span class=\"string\">&#x27;/html/body/div[2]/div/div[3]/div[3]/div[2]/div[2]/div[4]/span[3]&#x27;</span>)</span><br><span class=\"line\">    max_page = <span class=\"built_in\">int</span>(max_page_element.text)</span><br><span class=\"line\">    now_page = <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ **è·å–æˆåŠŸç«ä»·æ•°æ®**</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> now_page &lt;= max_page:</span><br><span class=\"line\">        u_blist = driver.find_element(By.ID, <span class=\"string\">&quot;u_blist&quot;</span>)</span><br><span class=\"line\">        successful_bids_data.extend(parse_successful_bids(u_blist))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(successful_bids_data) &gt;= target_successful_count:</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&quot;âœ… å·²è·å–æ‰€æœ‰æˆåŠŸç«ä»·ä¿¡æ¯&quot;</span>)</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># æ£€æŸ¥ `u_blistM` æ˜¯å¦å­˜åœ¨é¢å¤–çš„æˆåŠŸç«ä»·ä¿¡æ¯</span></span><br><span class=\"line\">        u_blistM = driver.find_element(By.ID, <span class=\"string\">&quot;u_blistM&quot;</span>)</span><br><span class=\"line\">        successful_bids_data.extend(parse_successful_bids(u_blistM))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(successful_bids_data) &gt;= target_successful_count:</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&quot;âœ… å·²è·å–æ‰€æœ‰æˆåŠŸç«ä»·ä¿¡æ¯&quot;</span>)</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># ğŸ“Œ **ç¿»é¡µ**</span></span><br><span class=\"line\">        next_button = wait.until(EC.element_to_be_clickable((By.XPATH, <span class=\"string\">&#x27;//*[@id=&quot;a_b_n&quot;]&#x27;</span>)))</span><br><span class=\"line\">        next_button.click()</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;ğŸ”„ åŠ è½½ç¬¬ <span class=\"subst\">&#123;now_page&#125;</span> é¡µ...&quot;</span>)</span><br><span class=\"line\">        now_page += <span class=\"number\">1</span></span><br><span class=\"line\">        time.sleep(<span class=\"number\">0.15</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ **è·å–æœªæˆåŠŸç«ä»·æ•°æ®**</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> now_page &lt;= max_page:</span><br><span class=\"line\">        u_blist = driver.find_element(By.ID, <span class=\"string\">&quot;u_blist&quot;</span>)</span><br><span class=\"line\">        unsuccessful_bids_data.extend(parse_unsuccessful_bids(u_blist, successful_bids_data))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># æ£€æŸ¥ `u_blistM` æ˜¯å¦å­˜åœ¨é¢å¤–çš„æœªæˆåŠŸç«ä»·ä¿¡æ¯</span></span><br><span class=\"line\">        u_blistM = driver.find_element(By.ID, <span class=\"string\">&quot;u_blistM&quot;</span>)</span><br><span class=\"line\">        unsuccessful_bids_data.extend(parse_unsuccessful_bids(u_blistM, successful_bids_data))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># ğŸ“Œ **ç¿»é¡µ**</span></span><br><span class=\"line\">        next_button = wait.until(EC.element_to_be_clickable((By.XPATH, <span class=\"string\">&#x27;//*[@id=&quot;a_b_n&quot;]&#x27;</span>)))</span><br><span class=\"line\">        next_button.click()</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;ğŸ”„ åŠ è½½ç¬¬ <span class=\"subst\">&#123;now_page&#125;</span> é¡µ...&quot;</span>)</span><br><span class=\"line\">        now_page += <span class=\"number\">1</span></span><br><span class=\"line\">        time.sleep(<span class=\"number\">0.15</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># **å»é‡å¤„ç†**</span></span><br><span class=\"line\">    unsuccessful_bids_data = deduplication(unsuccessful_bids_data)</span><br><span class=\"line\">    total_bids_data = successful_bids_data + unsuccessful_bids_data</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ **è·å–åº§ä½ä¿¡æ¯**</span></span><br><span class=\"line\">    seats = get_seat_positon(theater_name, bid_type, target_successful_count)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># **åˆ†é…åº§ä½å·**</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> idx, bid <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(total_bids_data):</span><br><span class=\"line\">        bid[<span class=\"string\">&quot;åº§ä½ç±»å‹&quot;</span>] = bid_type</span><br><span class=\"line\">        <span class=\"keyword\">if</span> idx &gt; <span class=\"built_in\">len</span>(seats) - <span class=\"number\">1</span>:</span><br><span class=\"line\">            bid[<span class=\"string\">&quot;åº§ä½å·&quot;</span>] = <span class=\"string\">&quot;ç«ä»·å¤±è´¥&quot;</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            bid[<span class=\"string\">&quot;åº§ä½å·&quot;</span>] = seats[idx]  <span class=\"comment\"># æ·»åŠ åº§ä½å·</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> total_bids_data</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ğŸ¯-2-ç»Ÿè®¡å½“å‰é¡µé¢ç«ä»·æ•°æ®å‰çš„å‡†å¤‡æ´»åŠ¨\"><a href=\"#ğŸ¯-2-ç»Ÿè®¡å½“å‰é¡µé¢ç«ä»·æ•°æ®å‰çš„å‡†å¤‡æ´»åŠ¨\" class=\"headerlink\" title=\"ğŸ¯ 2.ç»Ÿè®¡å½“å‰é¡µé¢ç«ä»·æ•°æ®å‰çš„å‡†å¤‡æ´»åŠ¨\"></a>ğŸ¯ <strong>2.ç»Ÿè®¡å½“å‰é¡µé¢ç«ä»·æ•°æ®å‰çš„å‡†å¤‡æ´»åŠ¨</strong></h3><h4 id=\"ğŸ“Œ-å‡½æ•°ï¼šstats-one-good\"><a href=\"#ğŸ“Œ-å‡½æ•°ï¼šstats-one-good\" class=\"headerlink\" title=\"ğŸ“Œ å‡½æ•°ï¼šstats_one_good\"></a>ğŸ“Œ <strong>å‡½æ•°ï¼š<code>stats_one_good</code></strong></h4><p>æ­¤å‡½æ•°ç”¨äºè·å–ä¸èŠ­å•†åŸçš„å•é¡µé¢ä¸‹çš„ç«ä»·æ•°æ®ï¼Œå¹¶å°†å…¶ä¿å­˜åˆ° Excel æ–‡ä»¶ä¸­ã€‚</p>\n<h5 id=\"ğŸ“œ-ä»£ç å®ç°-1\"><a href=\"#ğŸ“œ-ä»£ç å®ç°-1\" class=\"headerlink\" title=\"ğŸ“œ ä»£ç å®ç°\"></a>ğŸ“œ <strong>ä»£ç å®ç°</strong></h5><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">stats_one_good</span>(<span class=\"params\">driver</span>):</span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ è·å–å‰§é™¢åç§°å’Œ Excel æ–‡ä»¶å</span></span><br><span class=\"line\">    theater_name = driver.find_element(By.XPATH, <span class=\"string\">&quot;/html/body/div[2]/div/div[2]/div[2]/ul/li[2]/p&quot;</span>).text</span><br><span class=\"line\">    excel_name = driver.find_element(By.XPATH, <span class=\"string\">&quot;/html/body/div[2]/div/div[2]/div[2]/ul/li[1]&quot;</span>).text</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ è·å–å•†å“æ ‡é¢˜</span></span><br><span class=\"line\">    title_name_element = driver.find_element(By.CLASS_NAME, <span class=\"string\">&quot;i_tit&quot;</span>)</span><br><span class=\"line\">    title_name = title_name_element.text.strip()  <span class=\"comment\"># è·å–æ–‡æœ¬å†…å®¹å¹¶å»é™¤é¦–å°¾ç©ºæ ¼</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ è·å–å•†å“è¯¦ç»†ä¿¡æ¯å¹¶åˆ¤æ–­æ˜¯å¦ä¸ºç”Ÿæ—¥å…¬æ¼”</span></span><br><span class=\"line\">    item_info = driver.find_element(By.XPATH, <span class=\"string\">&#x27;//*[@id=&quot;TabTab03Con1&quot;]&#x27;</span>).get_attribute(<span class=\"string\">&#x27;outerHTML&#x27;</span>)</span><br><span class=\"line\">    soup = BeautifulSoup(item_info, <span class=\"string\">&#x27;html.parser&#x27;</span>)</span><br><span class=\"line\">    item_info_text = soup.get_text()</span><br><span class=\"line\">    birthday = <span class=\"string\">&quot;ç”Ÿæ—¥æ½®æµåŒ…&quot;</span> <span class=\"keyword\">in</span> item_info_text</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ ç¡®å®šç«ä»·ç±»å‹</span></span><br><span class=\"line\">    bid_type = get_seat_type(title_name)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ æ ¹æ®å‰§åœºå’Œå•†å“ç±»å‹é€‰æ‹©ç›¸åº”çš„ç«ä»·æ•°é‡</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"string\">&quot;SNH&quot;</span> <span class=\"keyword\">in</span> theater_name <span class=\"keyword\">and</span> <span class=\"string\">&quot;æ˜Ÿæ¢¦å‰§é™¢&quot;</span> <span class=\"keyword\">in</span> title_name <span class=\"keyword\">and</span> <span class=\"string\">&quot;MINILIVE&quot;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> title_name:</span><br><span class=\"line\">        bid_number = get_bid_number_SNH(bid_type, driver)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> birthday:</span><br><span class=\"line\">            theater_name = <span class=\"string\">&quot;SNHbirthday&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"string\">&quot;SNH&quot;</span> <span class=\"keyword\">in</span> theater_name <span class=\"keyword\">and</span> <span class=\"string\">&quot;æ˜Ÿæ¢¦ç©ºé—´&quot;</span> <span class=\"keyword\">in</span> title_name <span class=\"keyword\">and</span> <span class=\"string\">&quot;MINILIVE&quot;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> title_name:</span><br><span class=\"line\">        bid_number = get_bid_number_HGH(bid_type)</span><br><span class=\"line\">        theater_name = <span class=\"string\">&quot;HGH&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"string\">&quot;BEJ&quot;</span> <span class=\"keyword\">in</span> theater_name <span class=\"keyword\">and</span> <span class=\"string\">&quot;ç”Ÿæ—¥ä¼š&quot;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> title_name:</span><br><span class=\"line\">        bid_number = get_bid_number_BEJ(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"string\">&quot;MINILIVE&quot;</span> <span class=\"keyword\">in</span> title_name:</span><br><span class=\"line\">        bid_number = get_bid_number_MiniLive(driver)</span><br><span class=\"line\">        theater_name = <span class=\"string\">&quot;MINILIVE&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"string\">&quot;æ‹ç«‹å¾—&quot;</span> <span class=\"keyword\">in</span> title_name:</span><br><span class=\"line\">        bid_number = get_bid_number_pld(driver)</span><br><span class=\"line\">        theater_name = <span class=\"string\">&quot;æ‹ç«‹å¾—&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"string\">&quot;ç”Ÿæ—¥ä¼š&quot;</span> <span class=\"keyword\">in</span> title_name:</span><br><span class=\"line\">        bid_number = get_bid_number_birthparty(driver, theater_name)</span><br><span class=\"line\">        theater_name = <span class=\"string\">&quot;ç”Ÿæ—¥ä¼š&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;ğŸ« ç«ä»·å¸­ä½æ€»æ•°ï¼š<span class=\"subst\">&#123;bid_number&#125;</span>&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ ç«ä»·æµç¨‹</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> bid_number != <span class=\"number\">0</span>:</span><br><span class=\"line\">        max_bid_num = bid_number</span><br><span class=\"line\">        total_bids_data = auto_bid_until_end(driver, max_bid_num, bid_type, theater_name)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># ğŸ“Œ è·å–å•†å“ ID å¹¶ä¿å­˜ Excel æ•°æ®</span></span><br><span class=\"line\">        item_id = get_item_name(driver)</span><br><span class=\"line\">        save_excel(total_bids_data, item_id, excel_name)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ åˆ·æ–°é¡µé¢ï¼Œå‡†å¤‡ä¸‹ä¸€æ¬¡æ“ä½œ</span></span><br><span class=\"line\">    driver.refresh()</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ğŸ“Š-3-ä¿å­˜ç«ä»·æ•°æ®åˆ°-Excel\"><a href=\"#ğŸ“Š-3-ä¿å­˜ç«ä»·æ•°æ®åˆ°-Excel\" class=\"headerlink\" title=\"ğŸ“Š 3.ä¿å­˜ç«ä»·æ•°æ®åˆ° Excel\"></a>ğŸ“Š <strong>3.ä¿å­˜ç«ä»·æ•°æ®åˆ° Excel</strong></h3><h4 id=\"ğŸ“Œ-å‡½æ•°ï¼šsave-excel\"><a href=\"#ğŸ“Œ-å‡½æ•°ï¼šsave-excel\" class=\"headerlink\" title=\"ğŸ“Œ å‡½æ•°ï¼šsave_excel\"></a>ğŸ“Œ <strong>å‡½æ•°ï¼š<code>save_excel</code></strong></h4><p>æ­¤å‡½æ•°ç”¨äºå°†ç«ä»·æˆåŠŸçš„æ•°æ®ä¿å­˜åˆ° Excel æ–‡ä»¶ï¼Œæ”¯æŒå†™å…¥å•†å“åç§°ã€è¡¨å¤´ã€ç«ä»·ä¿¡æ¯ï¼Œå¹¶æ›´æ–°ç»Ÿè®¡ä¿¡æ¯ï¼ˆæœ€å°&#x2F;æœ€å¤§å‡ºä»·ã€æœ€æ—©&#x2F;æœ€æ™šå‡ºä»·ç­‰ï¼‰ã€‚</p>\n<h5 id=\"ğŸ“œ-ä»£ç å®ç°-2\"><a href=\"#ğŸ“œ-ä»£ç å®ç°-2\" class=\"headerlink\" title=\"ğŸ“œ ä»£ç å®ç°\"></a>ğŸ“œ <strong>ä»£ç å®ç°</strong></h5><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">save_excel</span>(<span class=\"params\">successful_bids_data, item_name, output_file=<span class=\"string\">&quot;bidding_results.xlsx&quot;</span></span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    å°†ç«ä»·æˆåŠŸæ•°æ®ä¿å­˜åˆ° Excel æ–‡ä»¶ã€‚</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    :param successful_bids_data: ç«ä»·æˆåŠŸçš„æ•°æ®åˆ—è¡¨</span></span><br><span class=\"line\"><span class=\"string\">    :param item_name: å•†å“åç§°</span></span><br><span class=\"line\"><span class=\"string\">    :param output_file: è¾“å‡ºæ–‡ä»¶åï¼ˆé»˜è®¤ï¼š&quot;bidding_results.xlsx&quot;ï¼‰</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ å°†æ•°æ®è½¬æ¢ä¸º Pandas DataFrame</span></span><br><span class=\"line\">    df = pd.DataFrame(successful_bids_data)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ åˆ›å»º Excel å·¥ä½œç°¿å’Œå·¥ä½œè¡¨</span></span><br><span class=\"line\">    wb = Workbook()</span><br><span class=\"line\">    ws = wb.active</span><br><span class=\"line\">    ws.title = <span class=\"string\">&quot;Bidding Results&quot;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ åœ¨ Excel æ–‡ä»¶çš„ç¬¬ä¸€è¡Œå†™å…¥å•†å“åç§°</span></span><br><span class=\"line\">    ws.append([item_name])</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ å†™å…¥è¡¨å¤´å¹¶åŠ ç²—</span></span><br><span class=\"line\">    header = [<span class=\"string\">&quot;å‡ºä»·çŠ¶æ€&quot;</span>, <span class=\"string\">&quot;å‡ºä»·äºº&quot;</span>, <span class=\"string\">&quot;å‡ºä»·æ—¶é—´&quot;</span>, <span class=\"string\">&quot;å‡ºä»·é‡‘é¢&quot;</span>, <span class=\"string\">&quot;åº§ä½ç±»å‹&quot;</span>, <span class=\"string\">&quot;åº§ä½å·&quot;</span>]</span><br><span class=\"line\">    ws.append(header)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">for</span> cell <span class=\"keyword\">in</span> ws[<span class=\"number\">2</span>]:  <span class=\"comment\"># ç¬¬äºŒè¡Œæ˜¯æ ‡é¢˜è¡Œ</span></span><br><span class=\"line\">        cell.font = Font(bold=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ å°†ç«ä»·æ•°æ®å†™å…¥ Excel</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> dataframe_to_rows(df, index=<span class=\"literal\">False</span>, header=<span class=\"literal\">False</span>):</span><br><span class=\"line\">        ws.append(row)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ æ›´æ–°æœ€å°/æœ€å¤§å‡ºä»·ã€æœ€æ—©/æœ€æ™šå‡ºä»·çš„å‡ºä»·äººä¿¡æ¯</span></span><br><span class=\"line\">    ws = update_min_max_info(df, ws)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ğŸ“Œ ä¿å­˜ Excel æ–‡ä»¶</span></span><br><span class=\"line\">    wb.save(output_file + <span class=\"string\">&quot;.xlsx&quot;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;âœ… ç«ä»·æˆåŠŸä¿¡æ¯å·²ä¿å­˜è‡³ <span class=\"subst\">&#123;output_file&#125;</span>.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n","text":"æ”¶é›†ä¸èŠ­ç‰¹æ®Šåœºç«ä»·å…¬æ¼”ä»¥åŠç«ä»·æ‹ç«‹å¾—æ•°æ®...","permalink":"/post/pythonProgram","photos":[],"count_time":{"symbolsCount":"6.9k","symbolsTime":"6 mins."},"categories":[],"tags":[{"name":"python","slug":"python","count":2,"path":"api/tags/python.json"},{"name":"çˆ¬è™«","slug":"çˆ¬è™«","count":2,"path":"api/tags/çˆ¬è™«.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%9D%E8%8A%AD%E5%95%86%E5%9F%8E%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA%E5%B7%A5%E5%85%B7\"><span class=\"toc-text\">ä¸èŠ­å•†åŸæ•°æ®å¯¼å‡ºå·¥å…·</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%A1%B9%E7%9B%AE%E7%AE%80%E4%BB%8B\"><span class=\"toc-text\">é¡¹ç›®ç®€ä»‹</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">åŠŸèƒ½ä»‹ç»</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BB%A3%E7%A0%81%E4%B8%BB%E8%A6%81%E5%AE%9E%E7%8E%B0%E9%83%A8%E5%88%86\"><span class=\"toc-text\">ä»£ç ä¸»è¦å®ç°éƒ¨åˆ†</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%F0%9F%8E%AF-1-%E8%8E%B7%E5%8F%96%E7%AB%9E%E4%BB%B7%E6%88%90%E5%8A%9F%E4%B8%8E%E5%A4%B1%E8%B4%A5%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">ğŸ¯ 1.è·å–ç«ä»·æˆåŠŸä¸å¤±è´¥æ•°æ®</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%F0%9F%93%8C-%E5%87%BD%E6%95%B0%EF%BC%9Aauto-bid-until-end\"><span class=\"toc-text\">ğŸ“Œ å‡½æ•°ï¼šauto_bid_until_end</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%F0%9F%93%8C-%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0\"><span class=\"toc-text\">ğŸ“Œ å‡½æ•°å‚æ•°</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%F0%9F%93%9C-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0\"><span class=\"toc-text\">ğŸ“œ ä»£ç å®ç°</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%F0%9F%8E%AF-2-%E7%BB%9F%E8%AE%A1%E5%BD%93%E5%89%8D%E9%A1%B5%E9%9D%A2%E7%AB%9E%E4%BB%B7%E6%95%B0%E6%8D%AE%E5%89%8D%E7%9A%84%E5%87%86%E5%A4%87%E6%B4%BB%E5%8A%A8\"><span class=\"toc-text\">ğŸ¯ 2.ç»Ÿè®¡å½“å‰é¡µé¢ç«ä»·æ•°æ®å‰çš„å‡†å¤‡æ´»åŠ¨</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%F0%9F%93%8C-%E5%87%BD%E6%95%B0%EF%BC%9Astats-one-good\"><span class=\"toc-text\">ğŸ“Œ å‡½æ•°ï¼šstats_one_good</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%F0%9F%93%9C-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-1\"><span class=\"toc-text\">ğŸ“œ ä»£ç å®ç°</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%F0%9F%93%8A-3-%E4%BF%9D%E5%AD%98%E7%AB%9E%E4%BB%B7%E6%95%B0%E6%8D%AE%E5%88%B0-Excel\"><span class=\"toc-text\">ğŸ“Š 3.ä¿å­˜ç«ä»·æ•°æ®åˆ° Excel</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%F0%9F%93%8C-%E5%87%BD%E6%95%B0%EF%BC%9Asave-excel\"><span class=\"toc-text\">ğŸ“Œ å‡½æ•°ï¼šsave_excel</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%F0%9F%93%9C-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-2\"><span class=\"toc-text\">ğŸ“œ ä»£ç å®ç°</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>","author":{"name":"Mess1A","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/187351171?s=400&u=9c476f29a83e3e29437a4a4b05a8f9e119a6a631&v=4","link":"/","description":"åªè¦æƒ³å¿µ <br /> å°±ä¼šç›¸è§","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"ä¸èŠ­å•†åŸåˆ‡ç¥¨","uid":"c86bd12937c2148f53e2425d8c90df48","slug":"ticketPlayWright","date":"2025-06-10T16:00:00.000Z","updated":"2025-07-28T02:27:19.088Z","comments":true,"path":"api/articles/ticketPlayWright.json","keywords":null,"cover":"./images/ticketPlayWright.jpg","text":"åˆ‡ç¥¨...","permalink":"/post/ticketPlayWright","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"python","slug":"python","count":2,"path":"api/tags/python.json"},{"name":"çˆ¬è™«","slug":"çˆ¬è™«","count":2,"path":"api/tags/çˆ¬è™«.json"},{"name":"playwright","slug":"playwright","count":1,"path":"api/tags/playwright.json"}],"author":{"name":"Mess1A","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/187351171?s=400&u=9c476f29a83e3e29437a4a4b05a8f9e119a6a631&v=4","link":"/","description":"åªè¦æƒ³å¿µ <br /> å°±ä¼šç›¸è§","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{}}