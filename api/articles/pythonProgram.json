{"title":"丝芭商城竞价数据统计","uid":"f3519b3c4b337b4d2b1c684904d9f509","slug":"pythonProgram","date":"2025-03-10T14:31:23.000Z","updated":"2025-07-28T02:27:19.087Z","comments":true,"path":"api/articles/pythonProgram.json","keywords":null,"cover":"./images/resume_icon.jpg","content":"<div class=\"custom-quote warning\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 8V13\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 15.99V16.01\"></path>\n</svg>\n</span>\n<p class=\"custom-quote-title\">WARNING</p>\n<p>本系统仅适用于丝芭商城，其他商城请自行修改代码。<br>本系统爬虫仅用于学习交流，请勿用于非法用途。</p>\n</div>\n<h1 id=\"丝芭商城数据导出工具\"><a href=\"#丝芭商城数据导出工具\" class=\"headerlink\" title=\"丝芭商城数据导出工具\"></a>丝芭商城数据导出工具</h1><h2 id=\"项目简介\"><a href=\"#项目简介\" class=\"headerlink\" title=\"项目简介\"></a>项目简介</h2><p>本项目是一个用于 <strong>自动化抓取和导出丝芭商城（<a href=\"https://shop.48.cn)拍卖数据/\">https://shop.48.cn）拍卖数据</a></strong> 的 Python 工具。<br>用户可以获取 <strong>指定拍卖页面</strong> 的信息，并将其整理后导出为 <strong>Excel 文件</strong>。  </p>\n<h2 id=\"功能介绍\"><a href=\"#功能介绍\" class=\"headerlink\" title=\"功能介绍\"></a>功能介绍</h2><ul>\n<li><strong>自动获取拍卖数据</strong>：解析商品详情页，提取关键信息，如竞拍价格、出价记录等。  </li>\n<li><strong>数据存储</strong>：将抓取的数据存入 Excel，方便后续分析。  </li>\n<li><strong>Tampermonkey 脚本支持</strong>：支持在浏览器中使用 Tampermonkey 直接获取数据。  </li>\n<li><strong>多线程优化</strong>：提升请求效率，减少等待时间。  </li>\n<li><strong>防反爬策略</strong>：加入请求间隔控制，降低被封风险。</li>\n</ul>\n<h2 id=\"代码主要实现部分\"><a href=\"#代码主要实现部分\" class=\"headerlink\" title=\"代码主要实现部分\"></a>代码主要实现部分</h2><h3 id=\"🎯-1-获取竞价成功与失败数据\"><a href=\"#🎯-1-获取竞价成功与失败数据\" class=\"headerlink\" title=\"🎯 1.获取竞价成功与失败数据\"></a>🎯 <strong>1.获取竞价成功与失败数据</strong></h3><h4 id=\"📌-函数：auto-bid-until-end\"><a href=\"#📌-函数：auto-bid-until-end\" class=\"headerlink\" title=\"📌 函数：auto_bid_until_end\"></a>📌 <strong>函数：<code>auto_bid_until_end</code></strong></h4><p>此函数用于自动执行竞价过程，直到达到指定的成功竞价数量，并收集所有竞价数据，包括成功和失败的竞价信息。  </p>\n<h5 id=\"📌-函数参数\"><a href=\"#📌-函数参数\" class=\"headerlink\" title=\"📌 函数参数\"></a>📌 <strong>函数参数</strong></h5><ul>\n<li><code>driver</code>：WebDriver 实例，用于与网页交互。  </li>\n<li><code>target_successful_count</code>：目标成功竞价的数量。  </li>\n<li><code>bid_type</code>：竞价类型（座位类别）。  </li>\n<li><code>theater_name</code>：剧院名称。</li>\n</ul>\n<h5 id=\"📜-代码实现\"><a href=\"#📜-代码实现\" class=\"headerlink\" title=\"📜 代码实现\"></a>📜 <strong>代码实现</strong></h5><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">auto_bid_until_end</span>(<span class=\"params\">driver, target_successful_count, bid_type, theater_name</span>):</span><br><span class=\"line\">    successful_bids_data = []  <span class=\"comment\"># 存储所有成功竞价信息</span></span><br><span class=\"line\">    unsuccessful_bids_data = []  <span class=\"comment\"># 存储所有未成功竞价信息</span></span><br><span class=\"line\">    total_bids_data = []</span><br><span class=\"line\">    wait = WebDriverWait(driver, <span class=\"number\">10</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 获取最大页数</span></span><br><span class=\"line\">    max_page_element = driver.find_element(By.XPATH, <span class=\"string\">&#x27;/html/body/div[2]/div/div[3]/div[3]/div[2]/div[2]/div[4]/span[3]&#x27;</span>)</span><br><span class=\"line\">    max_page = <span class=\"built_in\">int</span>(max_page_element.text)</span><br><span class=\"line\">    now_page = <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 📌 **获取成功竞价数据**</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> now_page &lt;= max_page:</span><br><span class=\"line\">        u_blist = driver.find_element(By.ID, <span class=\"string\">&quot;u_blist&quot;</span>)</span><br><span class=\"line\">        successful_bids_data.extend(parse_successful_bids(u_blist))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(successful_bids_data) &gt;= target_successful_count:</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&quot;✅ 已获取所有成功竞价信息&quot;</span>)</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># 检查 `u_blistM` 是否存在额外的成功竞价信息</span></span><br><span class=\"line\">        u_blistM = driver.find_element(By.ID, <span class=\"string\">&quot;u_blistM&quot;</span>)</span><br><span class=\"line\">        successful_bids_data.extend(parse_successful_bids(u_blistM))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(successful_bids_data) &gt;= target_successful_count:</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&quot;✅ 已获取所有成功竞价信息&quot;</span>)</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># 📌 **翻页**</span></span><br><span class=\"line\">        next_button = wait.until(EC.element_to_be_clickable((By.XPATH, <span class=\"string\">&#x27;//*[@id=&quot;a_b_n&quot;]&#x27;</span>)))</span><br><span class=\"line\">        next_button.click()</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;🔄 加载第 <span class=\"subst\">&#123;now_page&#125;</span> 页...&quot;</span>)</span><br><span class=\"line\">        now_page += <span class=\"number\">1</span></span><br><span class=\"line\">        time.sleep(<span class=\"number\">0.15</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 📌 **获取未成功竞价数据**</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> now_page &lt;= max_page:</span><br><span class=\"line\">        u_blist = driver.find_element(By.ID, <span class=\"string\">&quot;u_blist&quot;</span>)</span><br><span class=\"line\">        unsuccessful_bids_data.extend(parse_unsuccessful_bids(u_blist, successful_bids_data))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># 检查 `u_blistM` 是否存在额外的未成功竞价信息</span></span><br><span class=\"line\">        u_blistM = driver.find_element(By.ID, <span class=\"string\">&quot;u_blistM&quot;</span>)</span><br><span class=\"line\">        unsuccessful_bids_data.extend(parse_unsuccessful_bids(u_blistM, successful_bids_data))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># 📌 **翻页**</span></span><br><span class=\"line\">        next_button = wait.until(EC.element_to_be_clickable((By.XPATH, <span class=\"string\">&#x27;//*[@id=&quot;a_b_n&quot;]&#x27;</span>)))</span><br><span class=\"line\">        next_button.click()</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;🔄 加载第 <span class=\"subst\">&#123;now_page&#125;</span> 页...&quot;</span>)</span><br><span class=\"line\">        now_page += <span class=\"number\">1</span></span><br><span class=\"line\">        time.sleep(<span class=\"number\">0.15</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># **去重处理**</span></span><br><span class=\"line\">    unsuccessful_bids_data = deduplication(unsuccessful_bids_data)</span><br><span class=\"line\">    total_bids_data = successful_bids_data + unsuccessful_bids_data</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 📌 **获取座位信息**</span></span><br><span class=\"line\">    seats = get_seat_positon(theater_name, bid_type, target_successful_count)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># **分配座位号**</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> idx, bid <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(total_bids_data):</span><br><span class=\"line\">        bid[<span class=\"string\">&quot;座位类型&quot;</span>] = bid_type</span><br><span class=\"line\">        <span class=\"keyword\">if</span> idx &gt; <span class=\"built_in\">len</span>(seats) - <span class=\"number\">1</span>:</span><br><span class=\"line\">            bid[<span class=\"string\">&quot;座位号&quot;</span>] = <span class=\"string\">&quot;竞价失败&quot;</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            bid[<span class=\"string\">&quot;座位号&quot;</span>] = seats[idx]  <span class=\"comment\"># 添加座位号</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> total_bids_data</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"🎯-2-统计当前页面竞价数据前的准备活动\"><a href=\"#🎯-2-统计当前页面竞价数据前的准备活动\" class=\"headerlink\" title=\"🎯 2.统计当前页面竞价数据前的准备活动\"></a>🎯 <strong>2.统计当前页面竞价数据前的准备活动</strong></h3><h4 id=\"📌-函数：stats-one-good\"><a href=\"#📌-函数：stats-one-good\" class=\"headerlink\" title=\"📌 函数：stats_one_good\"></a>📌 <strong>函数：<code>stats_one_good</code></strong></h4><p>此函数用于获取丝芭商城的单页面下的竞价数据，并将其保存到 Excel 文件中。</p>\n<h5 id=\"📜-代码实现-1\"><a href=\"#📜-代码实现-1\" class=\"headerlink\" title=\"📜 代码实现\"></a>📜 <strong>代码实现</strong></h5><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">stats_one_good</span>(<span class=\"params\">driver</span>):</span><br><span class=\"line\">    <span class=\"comment\"># 📌 获取剧院名称和 Excel 文件名</span></span><br><span class=\"line\">    theater_name = driver.find_element(By.XPATH, <span class=\"string\">&quot;/html/body/div[2]/div/div[2]/div[2]/ul/li[2]/p&quot;</span>).text</span><br><span class=\"line\">    excel_name = driver.find_element(By.XPATH, <span class=\"string\">&quot;/html/body/div[2]/div/div[2]/div[2]/ul/li[1]&quot;</span>).text</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 📌 获取商品标题</span></span><br><span class=\"line\">    title_name_element = driver.find_element(By.CLASS_NAME, <span class=\"string\">&quot;i_tit&quot;</span>)</span><br><span class=\"line\">    title_name = title_name_element.text.strip()  <span class=\"comment\"># 获取文本内容并去除首尾空格</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 📌 获取商品详细信息并判断是否为生日公演</span></span><br><span class=\"line\">    item_info = driver.find_element(By.XPATH, <span class=\"string\">&#x27;//*[@id=&quot;TabTab03Con1&quot;]&#x27;</span>).get_attribute(<span class=\"string\">&#x27;outerHTML&#x27;</span>)</span><br><span class=\"line\">    soup = BeautifulSoup(item_info, <span class=\"string\">&#x27;html.parser&#x27;</span>)</span><br><span class=\"line\">    item_info_text = soup.get_text()</span><br><span class=\"line\">    birthday = <span class=\"string\">&quot;生日潮流包&quot;</span> <span class=\"keyword\">in</span> item_info_text</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 📌 确定竞价类型</span></span><br><span class=\"line\">    bid_type = get_seat_type(title_name)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 📌 根据剧场和商品类型选择相应的竞价数量</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"string\">&quot;SNH&quot;</span> <span class=\"keyword\">in</span> theater_name <span class=\"keyword\">and</span> <span class=\"string\">&quot;星梦剧院&quot;</span> <span class=\"keyword\">in</span> title_name <span class=\"keyword\">and</span> <span class=\"string\">&quot;MINILIVE&quot;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> title_name:</span><br><span class=\"line\">        bid_number = get_bid_number_SNH(bid_type, driver)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> birthday:</span><br><span class=\"line\">            theater_name = <span class=\"string\">&quot;SNHbirthday&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"string\">&quot;SNH&quot;</span> <span class=\"keyword\">in</span> theater_name <span class=\"keyword\">and</span> <span class=\"string\">&quot;星梦空间&quot;</span> <span class=\"keyword\">in</span> title_name <span class=\"keyword\">and</span> <span class=\"string\">&quot;MINILIVE&quot;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> title_name:</span><br><span class=\"line\">        bid_number = get_bid_number_HGH(bid_type)</span><br><span class=\"line\">        theater_name = <span class=\"string\">&quot;HGH&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"string\">&quot;BEJ&quot;</span> <span class=\"keyword\">in</span> theater_name <span class=\"keyword\">and</span> <span class=\"string\">&quot;生日会&quot;</span> <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> title_name:</span><br><span class=\"line\">        bid_number = get_bid_number_BEJ(driver)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"string\">&quot;MINILIVE&quot;</span> <span class=\"keyword\">in</span> title_name:</span><br><span class=\"line\">        bid_number = get_bid_number_MiniLive(driver)</span><br><span class=\"line\">        theater_name = <span class=\"string\">&quot;MINILIVE&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"string\">&quot;拍立得&quot;</span> <span class=\"keyword\">in</span> title_name:</span><br><span class=\"line\">        bid_number = get_bid_number_pld(driver)</span><br><span class=\"line\">        theater_name = <span class=\"string\">&quot;拍立得&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">elif</span> <span class=\"string\">&quot;生日会&quot;</span> <span class=\"keyword\">in</span> title_name:</span><br><span class=\"line\">        bid_number = get_bid_number_birthparty(driver, theater_name)</span><br><span class=\"line\">        theater_name = <span class=\"string\">&quot;生日会&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;🎫 竞价席位总数：<span class=\"subst\">&#123;bid_number&#125;</span>&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 📌 竞价流程</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> bid_number != <span class=\"number\">0</span>:</span><br><span class=\"line\">        max_bid_num = bid_number</span><br><span class=\"line\">        total_bids_data = auto_bid_until_end(driver, max_bid_num, bid_type, theater_name)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># 📌 获取商品 ID 并保存 Excel 数据</span></span><br><span class=\"line\">        item_id = get_item_name(driver)</span><br><span class=\"line\">        save_excel(total_bids_data, item_id, excel_name)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 📌 刷新页面，准备下一次操作</span></span><br><span class=\"line\">    driver.refresh()</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"📊-3-保存竞价数据到-Excel\"><a href=\"#📊-3-保存竞价数据到-Excel\" class=\"headerlink\" title=\"📊 3.保存竞价数据到 Excel\"></a>📊 <strong>3.保存竞价数据到 Excel</strong></h3><h4 id=\"📌-函数：save-excel\"><a href=\"#📌-函数：save-excel\" class=\"headerlink\" title=\"📌 函数：save_excel\"></a>📌 <strong>函数：<code>save_excel</code></strong></h4><p>此函数用于将竞价成功的数据保存到 Excel 文件，支持写入商品名称、表头、竞价信息，并更新统计信息（最小&#x2F;最大出价、最早&#x2F;最晚出价等）。</p>\n<h5 id=\"📜-代码实现-2\"><a href=\"#📜-代码实现-2\" class=\"headerlink\" title=\"📜 代码实现\"></a>📜 <strong>代码实现</strong></h5><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">save_excel</span>(<span class=\"params\">successful_bids_data, item_name, output_file=<span class=\"string\">&quot;bidding_results.xlsx&quot;</span></span>):</span><br><span class=\"line\">    <span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">    将竞价成功数据保存到 Excel 文件。</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    :param successful_bids_data: 竞价成功的数据列表</span></span><br><span class=\"line\"><span class=\"string\">    :param item_name: 商品名称</span></span><br><span class=\"line\"><span class=\"string\">    :param output_file: 输出文件名（默认：&quot;bidding_results.xlsx&quot;）</span></span><br><span class=\"line\"><span class=\"string\">    &quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 📌 将数据转换为 Pandas DataFrame</span></span><br><span class=\"line\">    df = pd.DataFrame(successful_bids_data)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 📌 创建 Excel 工作簿和工作表</span></span><br><span class=\"line\">    wb = Workbook()</span><br><span class=\"line\">    ws = wb.active</span><br><span class=\"line\">    ws.title = <span class=\"string\">&quot;Bidding Results&quot;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 📌 在 Excel 文件的第一行写入商品名称</span></span><br><span class=\"line\">    ws.append([item_name])</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 📌 写入表头并加粗</span></span><br><span class=\"line\">    header = [<span class=\"string\">&quot;出价状态&quot;</span>, <span class=\"string\">&quot;出价人&quot;</span>, <span class=\"string\">&quot;出价时间&quot;</span>, <span class=\"string\">&quot;出价金额&quot;</span>, <span class=\"string\">&quot;座位类型&quot;</span>, <span class=\"string\">&quot;座位号&quot;</span>]</span><br><span class=\"line\">    ws.append(header)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">for</span> cell <span class=\"keyword\">in</span> ws[<span class=\"number\">2</span>]:  <span class=\"comment\"># 第二行是标题行</span></span><br><span class=\"line\">        cell.font = Font(bold=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 📌 将竞价数据写入 Excel</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> dataframe_to_rows(df, index=<span class=\"literal\">False</span>, header=<span class=\"literal\">False</span>):</span><br><span class=\"line\">        ws.append(row)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 📌 更新最小/最大出价、最早/最晚出价的出价人信息</span></span><br><span class=\"line\">    ws = update_min_max_info(df, ws)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 📌 保存 Excel 文件</span></span><br><span class=\"line\">    wb.save(output_file + <span class=\"string\">&quot;.xlsx&quot;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">f&quot;✅ 竞价成功信息已保存至 <span class=\"subst\">&#123;output_file&#125;</span>.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n","text":"收集丝芭特殊场竞价公演以及竞价拍立得数据...","permalink":"/post/pythonProgram","photos":[],"count_time":{"symbolsCount":"6.9k","symbolsTime":"6 mins."},"categories":[],"tags":[{"name":"python","slug":"python","count":2,"path":"api/tags/python.json"},{"name":"爬虫","slug":"爬虫","count":2,"path":"api/tags/爬虫.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%9D%E8%8A%AD%E5%95%86%E5%9F%8E%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA%E5%B7%A5%E5%85%B7\"><span class=\"toc-text\">丝芭商城数据导出工具</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%A1%B9%E7%9B%AE%E7%AE%80%E4%BB%8B\"><span class=\"toc-text\">项目简介</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8A%9F%E8%83%BD%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">功能介绍</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BB%A3%E7%A0%81%E4%B8%BB%E8%A6%81%E5%AE%9E%E7%8E%B0%E9%83%A8%E5%88%86\"><span class=\"toc-text\">代码主要实现部分</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%F0%9F%8E%AF-1-%E8%8E%B7%E5%8F%96%E7%AB%9E%E4%BB%B7%E6%88%90%E5%8A%9F%E4%B8%8E%E5%A4%B1%E8%B4%A5%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">🎯 1.获取竞价成功与失败数据</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%F0%9F%93%8C-%E5%87%BD%E6%95%B0%EF%BC%9Aauto-bid-until-end\"><span class=\"toc-text\">📌 函数：auto_bid_until_end</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%F0%9F%93%8C-%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0\"><span class=\"toc-text\">📌 函数参数</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%F0%9F%93%9C-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0\"><span class=\"toc-text\">📜 代码实现</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%F0%9F%8E%AF-2-%E7%BB%9F%E8%AE%A1%E5%BD%93%E5%89%8D%E9%A1%B5%E9%9D%A2%E7%AB%9E%E4%BB%B7%E6%95%B0%E6%8D%AE%E5%89%8D%E7%9A%84%E5%87%86%E5%A4%87%E6%B4%BB%E5%8A%A8\"><span class=\"toc-text\">🎯 2.统计当前页面竞价数据前的准备活动</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%F0%9F%93%8C-%E5%87%BD%E6%95%B0%EF%BC%9Astats-one-good\"><span class=\"toc-text\">📌 函数：stats_one_good</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%F0%9F%93%9C-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-1\"><span class=\"toc-text\">📜 代码实现</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%F0%9F%93%8A-3-%E4%BF%9D%E5%AD%98%E7%AB%9E%E4%BB%B7%E6%95%B0%E6%8D%AE%E5%88%B0-Excel\"><span class=\"toc-text\">📊 3.保存竞价数据到 Excel</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%F0%9F%93%8C-%E5%87%BD%E6%95%B0%EF%BC%9Asave-excel\"><span class=\"toc-text\">📌 函数：save_excel</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%F0%9F%93%9C-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-2\"><span class=\"toc-text\">📜 代码实现</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>","author":{"name":"Mess1A","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/187351171?s=400&u=9c476f29a83e3e29437a4a4b05a8f9e119a6a631&v=4","link":"/","description":"只要想念 <br /> 就会相见","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"丝芭商城切票","uid":"c86bd12937c2148f53e2425d8c90df48","slug":"ticketPlayWright","date":"2025-06-10T16:00:00.000Z","updated":"2025-07-28T02:27:19.088Z","comments":true,"path":"api/articles/ticketPlayWright.json","keywords":null,"cover":"./images/ticketPlayWright.jpg","text":"切票...","permalink":"/post/ticketPlayWright","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"python","slug":"python","count":2,"path":"api/tags/python.json"},{"name":"爬虫","slug":"爬虫","count":2,"path":"api/tags/爬虫.json"},{"name":"playwright","slug":"playwright","count":1,"path":"api/tags/playwright.json"}],"author":{"name":"Mess1A","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/187351171?s=400&u=9c476f29a83e3e29437a4a4b05a8f9e119a6a631&v=4","link":"/","description":"只要想念 <br /> 就会相见","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{}}